[TOC]



智路科技代码规范文档，约定对象为开发部人员（Java开发工程师），开发人员须严格按照该文档相关约定进行开发，以提高代码质量与个人编码水平。



# 一、IDEA代码注释风格

## 1.1 类注释模板设置

IDEA --> Settings... --> Editor --> File and Code Templates --> Includes -->File Header

```java
/**
*   Description: 
*   Author: ${USER}
*   Datetime: ${DATE}
*/
```



## 1.2 方法注释模板设置

IDEA --> Settings... --> Editor --> Live Templates --> 点击**+**号 -->Template Group...(添加模板组)

添加了模板组后再次点击**+**号，这次选择Live Template(添加注释模板)

1. Abbreviation: 该处填入***** **（注意\**设置的模板名称为\*，\**此处一定要填写\*,因为IDEA生成注释的默认方式是：/\*+模板名+快捷键）**
2. Description：该处填入调用模板时的提示
3. Template text内容（一定要以***\***开头）：

```java
**
 * 功能描述: 
 * 创建时间: $date$ 
 $params$
 $return$ 
 * author: xxxxx
 */
```

4. Edit variables：

params Default value内容：

```java
groovyScript("if(\"${_1}\".length() == 2) {return '';} else {def result=''; def params=\"${_1}\".replaceAll('[\\\\[|\\\\]|\\\\s]', '').split(',').toList();for(i = 0; i < params.size(); i++) {if(i==0){result+='* @param ' + params[i] + ': '}else{result+='\\n' + ' * @param ' + params[i] + ': '}}; return result;}", methodParameters());
```

return Default value内容：

```java
groovyScript("def returnType = \"${_1}\"; def result = '* @return ' + returnType; return result;", methodReturnType());
```

author、date、time处变量分别点击，下拉后选择user(),date(),time()

- name没有time，不用选择time()。

![](https://img2018.cnblogs.com/blog/1779202/201909/1779202-20190926082026910-1818489985.png)



5. Expand with处选择Tab键补全，默认也是按Tab键补全（设置为Enter键，类属性文档注释会有冲突）

![](https://img2018.cnblogs.com/blog/1779202/201909/1779202-20190926082612507-2058477579.png)



6. Change处选择Java

![](https://img2018.cnblogs.com/blog/1779202/201909/1779202-20190926083110038-1582455733.png)

测试效果：

- 方法上输入**/\***后按Tab键自动补全

# 二、命名规则

## 2.1 包命名规则

> 1. `若项目名称为：abc`
> 2. `- java `com.zlkj.abc` 对应 前台目录：`back/abc``
> 3. `    + `com.zlkj.abc.model` 数据库模型层`
> 4. `    + `com.zlkj.abc.controller` 控制器层`
> 5. `    + `com.zlkj.abc.repository` 持久化层`
> 6. `    + `com.zlkj.abc.service` 服务接口层`
> 7. `    + `com.zlkj.abc.service.impl` 服务实现类层`

## 2.2 类名命名规则

> 1. `- controller 根据业务命名 `*Controller``
> 2. `- service 与`contoller` 一一对应 `*Service` 实现类 `*ServiceImpl``
> 3. `- repository 与数据库模型 一一对应 `*Repository``

## 2.3 方法命名规则

| 功能      | 业务级(service,controller) | 对象级(repository) |
| --------- | -------------------------- | ------------------ |
| 查询      | query                      | read               |
| 增加      | add                        | create             |
| 修改      | edit                       | update             |
| 删除      | remove                     | delete             |
| 计算      | ccl                        | count              |
| 初始化    | init                       |                    |
| 保存      | save                       |                    |
| 生成/创建 | generate                   |                    |

## 2.4 Controller命名规范

> 默认情况下 创建好controller之后 继承于 JGPController 可不写任何控制规则 就可以 随意访问对应的页面，如下：
> 映射路径 abc/user 前台对应目录 back/abc/user/index.htm
> 映射路径 abc/user/index 前台对应目录 back/abc/user/index.htm
> 映射路径 abc/foo 前台对应目录 back/abc/foo/index.htm
> 映射路径 abc/foo/123 前台对应目录 back/abc/foo/123.htm

# 三、编程规约

## 3.1 命名风格

1. 【强制】代码中的命名均不能以下划线或美元符号开始，也不能以下划线或美元符号结束。
   反例:_name/_name / $name / name_/ name$ / name_

2. 【强制】类名使用 UpperCamelCase 风格。

   正例：ForceCode / UserDO / HtmlDTO / XmlService / TcpUdpDeal / TaPromotion

   反例：forcecode / UserDo / HTMLDto / XMLService / TCPUDPDeal / TAPromotion

3. 【强制】方法名、参数名、成员变量、局部变量都统一使用 lowerCamelCase 风格。

   正例： localValue / getHttpMessage() / inputUserId

4. 【强制】常量命名全部大写，单词间用下划线隔开，力求语义表达完整清楚，不要嫌名字长。

   正例：MAX_STOCK_COUNT / CACHE_EXPIRED_TIME

   反例：MAX_COUNT / EXPIRED_TIME

5. 【强制】类型与中括号紧挨相连来表示数组。

   正例：定义整形数组 int[] arrayDemo;

   反例：在 main 参数中，使用 String args[]来定义。

6. 【强制】POJO 类中的任何布尔类型的变量，都不要加 is 前缀，否则部分框架解析会引起序列

   化错误。

   反例：定义为基本数据类型 Boolean isDeleted 的属性，它的方法也是 isDeleted()，框架在反向解析的时

   候，“误以为”对应的属性名称是 deleted，导致属性获取不到，进而抛出异常。

7. 【强制】包名统一使用小写，点分隔符之间有且仅有一个自然语义的英语单词。包名统一使用

   单数形式，但是类名如果有复数含义，类名可以使用复数形式。

   正例：应用工具类包名为 com.alibaba.ei.kunlun.aap.util、类名为 MessageUtils

   8. 【强制】方法命名必须要能反映出该方法的具体功能或业务描述。

   

## 3.2 常量定义

1. 【强制】在 long 或者 Long 赋值时，数值后使用大写的 L，不能是小写的 l，小写容易跟数字

   混淆，造成误解。

   说明：Long a = 2l; 写的是数字的 21，还是 Long 型的 2。




## 3.3 代码格式

1. 【强制】如果是大括号内为空，则简洁地写成{}即可，大括号中间无需换行和空格；如果是非

   空代码块则： 

   1） 左大括号前不换行。

   2） 左大括号后换行。

   3） 右大括号前换行。

   4） 右大括号后还有 else 等代码则不换行；表示终止的右大括号后必须换行。

2. 【强制】左小括号和右边相邻字符之间不出现空格；右小括号和左边相邻字符之间也不出现空

   格；而左大括号前需要加空格。详见第 5 条下方正例提示。（常用快捷键代码格式化）

   反例：if (空格 a == b 空格)

   3.【强制】方法参数在定义和传入时，多个参数逗号后边必须加空格。

   正例：下例中实参的 args1，后边必须要有一个空格。

   method(args1, args2, args3);  （常用快捷键代码格式化）

   

## 3.4 注释规约

1. 【强制】类、类属性、类方法的注释必须使用 Javadoc 规范，使用/**内容*/格式，不得使用

   // xxx 方式。

   说明：在 IDE 编辑窗口中，Javadoc 方式会提示相关注释，生成 Javadoc 可以正确输出相应注释；在 IDE

   中，工程调用方法时，不进入方法即可悬浮提示方法、参数、返回值的意义，提高阅读效率。

2. 【强制】所有的类都必须添加创建者和创建日期。

   说明：在设置模板时，注意 IDEA 的@author 为`${USER}`，而 eclipse 的@author 为`${user}`，大小写有

   区别，而日期的设置统一为 yyyy/MM/dd 的格式。

4. 【强制】所有的枚举类型字段必须要有注释，说明每个数据项的用途。

5. 【强制】代码修改的同时，注释也要进行相应的修改，尤其是参数、返回值、异常、核心逻辑

   等的修改。

   说明：代码与注释更新不同步，就像路网与导航软件更新不同步一样，如果导航软件严重滞后，就失去了

   导航的意义。

6. 【强制】在类中删除未使用的任何字段和方法；在方法中删除未使用的任何参数声明与内部变

   量。

7. 【参考】谨慎注释掉代码。在上方详细说明，而不是简单地注释掉。如果无用，则删除。

   说明：代码被注释掉有两种可能性：1）后续会恢复此段代码逻辑。2）永久不用。前者如果没有备注信息，

   难以知晓注释动机。后者建议直接删掉即可，假如需要查阅历史代码，登录代码仓库即可。

8. .【参考】对于注释的要求：第一、能够准确反映设计思想和代码逻辑；第二、能够描述业务含

   义，使别的程序员能够迅速了解到代码背后的信息。完全没有注释的大段代码对于阅读者形同

   天书，注释是给自己看的，即使隔很长时间，也能清晰理解当时的思路；注释也是给继任者看

   的，使其能够快速接替自己的工作。

9. 【参考】好的命名、代码结构是自解释的，注释力求精简准确、表达到位。避免出现注释的一

   个极端：过多过滥的注释，代码的逻辑一旦修改，修改注释是相当大的负担。

10. 【参考】特殊注释标记，请注明标记人与标记时间。注意及时处理这些标记，通过标记扫描，

    经常清理此类标记。线上故障有时候就是来源于这些标记处的代码。

    1） 待办事宜（TODO）:（标记人，标记时间，[预计处理时间]）

    表示需要实现，但目前还未实现的功能。这实际上是一个 Javadoc 的标签，目前的 Javadoc 还没

    有实现，但已经被广泛使用。只能应用于类，接口和方法（因为它是一个 Javadoc 标签）。


## 3.6 日期时间

1. 【强制】日期格式化时，传入 pattern 中表示年份统一使用小写的 y。

   说明：日期格式化时，yyyy 表示当天所在的年，而大写的 YYYY 代表是 week in which year（JDK7 之后

   引入的概念），意思是当天所在的周属于的年份，一周从周日开始，周六结束，只要本周跨年，返回的 YYYY

   就是下一年。

   正例：表示日期和时间的格式如下所示：

   ```java
   new SimpleDateFormat("yyyy-MM-dd HH:mm:ss")
   ```

3. 【强制】获取当前毫秒数：System.currentTimeMillis(); 而不是 new Date().getTime()。

   说明：如果想获取更加精确的纳秒级时间值，使用 System.nanoTime 的方式。在 JDK8 中，针对统计时间

   等场景，推荐使用 Instant 类。


## 3.7 集合处理

1. 【强制】判断所有集合内部的元素是否为空，使用 isEmpty()方法，而不是 size()==0 的方式。

   说明：前者的时间复杂度为 O(1)，而且可读性更好。

   正例：

   Map<String, Object> map = new HashMap<>();

   if(map.isEmpty()) {

    System.out.println("no element in this map.");

   }

2. 【强制】不要在 foreach 循环里进行数据库的循环操作

   正例：

   ```java
List<String> list = new ArrayList<>();
   list.add("1");
   list.add("2");
   Iterator<String> iterator = list.iterator();
   while (iterator.hasNext()) {
       String item = iterator.next();
       if (删除元素的条件) {
            iterator.remove();
       } 
   }
   ```
   
   

   反例：

   ```java
for (String item : list) {
       if ("1".equals(item)) {
         list.remove(item);
       } 
   }
   ```
   
4. 【推荐】使用 entrySet 遍历 Map 类集合 KV，而不是 keySet 方式进行遍历。

   说明：keySet 其实是遍历了 2 次，一次是转为 Iterator 对象，另一次是从 hashMap 中取出 key 所对应的

   value。而 entrySet 只是遍历了一次就把 key 和 value 都放到了 entry 中，效率更高。如果是 JDK8，使用

   Map.forEach 方法。

   正例：values()返回的是 V 值集合，是一个 list 集合对象；keySet()返回的是 K 值集合，是一个 Set 集合对

   象；entrySet()返回的是 K-V 值组合集合

## 3.8 并发处理

1. 【推荐】获取单例对象需要保证线程安全，其中的方法也要保证线程安全。

   说明：资源驱动类、工具类、单例工厂类都需要注意。

2. 【推荐】SimpleDateFormat 是线程不安全的类，一般不要定义为 static 变量，如果定义为 static，

   必须加锁，或者使用 DateUtils 工具类。

   正例：注意线程安全，使用 DateUtils。亦推荐如下处理：

   ```java
   private static final ThreadLocal<DateFormat> df = new ThreadLocal<DateFormat>() {
       @Override
       protected DateFormat initialValue() {
            return new SimpleDateFormat("yyyy-MM-dd");
       }
   };
   ```

   

## 3.9 控制语句

1. 【强制】在一个 switch 块内，每个 case 要么通过 continue/break/return 等来终止，要么

   注释说明程序将继续执行到哪一个 case 为止；在一个 switch 块内，都必须包含一个 default语句并且放在最后，即使它什么代码也没有。

   说明：注意 break 是退出 switch 语句块，而 return 是退出方法体。

2. 【强制】当 switch 括号内的变量类型为 String 并且此变量为外部参数时，必须先进行 null

   判断。

   反例：如下的代码输出是什么？

   ```java
   public class SwitchString {
      public static void main(String[] args) {
         method(null);
      }
   
    public static void method(String param) {
       switch (param) {
         // 肯定不是进入这里
         case "sth":
           System.out.println("it's sth");
           break;
         // 也不是进入这里
         case "null":
           System.out.println("it's null");
           break;
         // 也不是进入这里
         default:
           System.out.println("default");
       }
    } 
   }
   ```

   

3. 【强制】在 if/else/for/while/do 语句中必须使用大括号。

   说明：即使只有一行代码，禁止不采用大括号的编码方式：if (condition) statements; 

4. 【推荐】三目运算符 condition? 表达式 1 : 表达式 2 中，高度注意表达式 1 和 2 在类型对齐

   时，可能抛出因自动拆箱导致的 NPE 异常。

   说明：以下两种场景会触发类型对齐的拆箱操作：

   1） 表达式 1 或表达式 2 的值只要有一个是原始类型。

   2） 表达式 1 或表达式 2 的值的类型不一致，会强制拆箱升级成表示范围更大的那个类型。

   反例：

   ```java
   Integer a = 1;
   Integer b = 2;
   Integer c = null;
   Boolean flag = false;
   // a*b 的结果是 int 类型，那么 c 会强制拆箱成 int 类型，抛出 NPE 异常
   Integer result=(flag? a*b : c);
   ```

   

## 3.10 其他

1. 【强制】在使用正则表达式时，利用好其预编译功能，可以有效加快正则匹配速度。

   说明：不要在方法体内定义：Pattern pattern = Pattern.compile(“规则”);

2. 【强制】后台输送给页面的变量必须加${var!''}——中间的感叹号。

5. 【推荐】及时清理不再使用的代码段或配置信息。

   说明：对于垃圾代码或过时配置，坚决清理干净，避免程序过度臃肿，代码冗余。

   正例：对于暂时被注释掉，后续可能恢复使用的代码片断，在注释代码上方，统一规定使用三个斜杠(///)

   来说明注释掉代码的理由。如：

   ```java
   public static void hello() {
      /// 业务方通知活动暂停
      // Business business = new Business();
      // business.active();
      System.out.println("it's finished");
   }
   ```

   

# 四、IDEA插件-Alibaba代码规约实时检测

打开 Settings >> Plugins 

搜索：Alibaba Java Coding Guidelines，然后install，restart一次IDEA即可。



# 五、Git Commit代码提交规范

代码提交信息的说明，能够使项目在后期协作以及Bug处理时更加容易理解

## 5.1 commit message格式

> <type>: <subject>
>
> 注意：冒号后面又空格



## 5.2 type 用于说明commit的类别

- feat：新功能（feature）
- fix：修补bug
- docs：文档（documentation）
- stype：格式（不影响代码运行的变动）
- refactor：重构：（即不是新增功能，也不是修改bug的代码变动）
- test：增加测试
- chore：构建过程或辅助工具的变动

## 5.3 subject 是commit代码的简短描述



